import"./modulepreload-polyfill-3cfb730f.js";import{h as H,i as G,D as R,m as z,W as N,L as U,o as K,T as F,a as J,P as $,M as q,f as V,p as E,A as Q,g as v}from"./index-b74b9157.js";class X{constructor({gameWidth:e,gameHeight:s}){this.gameWidth=e,this.gameHeight=s,this.init(),this.loaded=!1}init(){this.scene=new H,this.camera=new G(30,this.gameWidth/this.gameHeight,1,1e4),this.camera.position.set(0,30,1800),this.camera.lookAt(0,0,100),this.light=new R(16777215,.6),this.light.position.set(-500,300,500),this.scene.add(this.light),this.clock=new z,this.renderer=new N({antialias:!0}),this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setSize(this.gameWidth,this.gameHeight),document.getElementById("body").appendChild(this.renderer.domElement),this.loadingManager=new U;const s=new K(this.loadingManager).load(["../resources/Textures/posx.jpg","../resources/Textures/negx.jpg","../resources/Textures/posy.jpg","../resources/Textures/negy.jpg","../resources/Textures/posz.jpg","../resources/Textures/negz.jpg"]);this.scene.background=s;const g=new F(this.loadingManager).load("../resources/Textures/negy.jpg"),a=new J(new $(4150,2e3),new q({map:g}));a.rotation.x=-Math.PI/2,a.position.set(0,-450,-100),this.scene.add(a),this.loader=new V(this.loadingManager),this.loadedCharacters={player1:{},player2:{}},Object.keys(E).forEach((y,w)=>{const h=E[y];Object.keys(this.loadedCharacters).forEach(f=>{const b=this.loadedCharacters[f];this.loader.load(h.model,p=>{const I=new Q(p);p.visible=!1,p.scale.setScalar(h.scale);const C=p;f==="player1"?(C.rotation.y=Math.PI/2,C.position.set(-500,-350,-170)):(C.rotation.y=-Math.PI/2,C.position.set(500,-350,-170)),this.loader.load(h.animations[0].src,P=>{var W=I.clipAction(P.animations[0]);W.play(),this.scene.add(p);const O=w+1;b[O]={mesh:C,mixer:I}})})})})}update(){let e=this.clock.getDelta();e>.1&&(e=.1),this.loaded&&Object.keys(this.loadedCharacters).forEach(s=>{const c=this.loadedCharacters[s];Object.keys(c).forEach(g=>{c[g].mixer.update(e)})}),this.renderer.render(this.scene,this.camera)}}const Z=document.getElementById("backgroundAudio"),n=document.getElementById("miscAudio");let x={player1:null,player2:null},o={player1:{row:1,column:1},player2:{row:null,column:null}},t="player1",T=[],M,u,m=0,d,i=new X({gameWidth:innerWidth,gameHeight:innerHeight});i.loadingManager.onProgress=(r,e,s)=>{const c=e/s*100;v.to("#leftBar",{width:c+"%"}),v.to("#rightBar",{width:c+"%"})};i.loadingManager.onLoad=()=>{document.getElementById("loadingScreen").style.display="none",document.getElementById("body").style.display="block",Z.play(),M=localStorage.getItem("Mode"),u=JSON.parse(localStorage.getItem("Controllers")),M===null&&(typeof window.electronAPI<"u"?window.electronAPI.navigateTo("index.html"):A("")),u===null&&(typeof window.electronAPI<"u"?window.electronAPI.navigateTo("SelectController/index.html"):A("SelectController")),l(),addEventListener("keydown",r=>{if(r.keyCode===76&&u.player1==="Keyboard"&&(t==="player2"?(t="player1",x.player1=null,o.player2={row:null,column:null},n.currentTime=0,n.src="../resources/Audios/menu-click-89198.mp3",n.play(),L(),l()):typeof window.electronAPI<"u"?window.electronAPI.navigateTo("SelectController/index.html"):A("SelectController")),u[t]==="Keyboard"||u.player1==="Keyboard"&&u.player2==="Computer")switch(r.keyCode){case 74:n.currentTime=0,n.src="../resources/Audios/menu-click-89198.mp3",n.play(),j();break;case 65:o[t].column>1?o[t].column--:o[t].column=3,l(),n.currentTime=0,n.src="../resources/Audios/menu-button-88360.mp3",n.play();break;case 68:o[t].column<3?o[t].column++:o[t].column=1,l(),n.currentTime=0,n.src="../resources/Audios/menu-button-88360.mp3",n.play();break;case 83:o[t].row>1?o[t].row--:o[t].row=2,l(),n.currentTime=0,n.src="../resources/Audios/menu-button-88360.mp3",n.play();break;case 87:o[t].row<2?o[t].row++:o[t].row=1,l(),n.currentTime=0,n.src="../resources/Audios/menu-button-88360.mp3",n.play();break}}),addEventListener("gamepadconnected",r=>{let e=r.gamepad.index;T.push(e)}),addEventListener("gamepaddisconnected",r=>{let e=r.gamepad.index;T=T.filter(s=>s!==e)}),addEventListener("resize",()=>{i.gameWidth=innerWidth,i.gameHeight=innerHeight,i.renderer.setSize(innerWidth,innerHeight),i.camera.aspect=innerWidth/innerHeight,i.camera.updateProjectionMatrix()}),i.loaded=!0,S()};function _(){m++,T.forEach(r=>{let e=navigator.getGamepads()[r];if(e.buttons[2].pressed&&u.player1===r&&(Math.abs(m-d)>10||d===void 0)&&(t==="player2"?(d=m,t="player1",x.player1=null,o.player2={row:null,column:null},L(),l()):typeof window.electronAPI<"u"?window.electronAPI.navigateTo("SelectController/index.html"):A("SelectController")),(u[t]===r||u.player1===r&&u.player2==="Computer")&&(Math.abs(m-d)>10||d===void 0)){var c=k(e.axes[0],.25),g=k(e.axes[1],.25),a=k(e.axes[9],.25);e.buttons.map(b=>b.pressed).forEach((b,p)=>{if(b)switch(p){case 1:d=m,n.currentTime=0,n.src="../resources/Audios/menu-click-89198.mp3",n.play(),j();break}});let y,w,h,f;if(e.buttons[12]&&e.buttons[13]&&e.buttons[14]&&e.buttons[15]?(y=e.buttons[12].pressed||a<-.9,w=e.buttons[13].pressed||a===0,h=e.buttons[14].pressed||a>0&&a<=1,f=e.buttons[15].pressed||a<0&&a>-.9):(y=a<-.9,w=a===0,h=a>0&&a<=1,f=a<0&&a>-.9),g>0||y){d=m,o[t].row>1?o[t].row--:o[t].row=2,l(),n.currentTime=0,n.src="../resources/Audios/menu-button-88360.mp3",n.play();return}if(g<0||w){d=m,o[t].row<2?o[t].row++:o[t].row=1,l(),n.currentTime=0,n.src="../resources/Audios/menu-button-88360.mp3",n.play();return}if(c>0||f){d=m,o[t].column<3?o[t].column++:o[t].column=1,l(),n.currentTime=0,n.src="../resources/Audios/menu-button-88360.mp3",n.play();return}if(c<0||h){d=m,o[t].column>1?o[t].column--:o[t].column=3,l(),n.currentTime=0,n.src="../resources/Audios/menu-button-88360.mp3",n.play();return}}})}function k(r,e,s){return s=(Math.abs(r)-e)/(1-e),s<0&&(s=0),s*(r>0?1:-1)}function S(){i.update(),_(),requestAnimationFrame(S)}function j(){const r=o[t],e=B(r.row,r.column),s=document.getElementById(e).innerText;t==="player2"&&s===x.player1||(x[t]=s,t==="player1"?(t="player2",e!==1?o[t]={row:1,column:1}:o[t]={row:1,column:2},l()):(localStorage.setItem("Characters",JSON.stringify(x)),setTimeout(()=>{typeof window.electronAPI<"u"?window.electronAPI.navigateTo("GamePage/index.html"):A("Gamepage")},500)))}function l(){for(let r=1;r<7;r++)document.getElementById(r).style.backgroundColor="white";Object.keys(o).forEach(r=>{const e=o[r];if(e.row===null||e.column===null)return;const s=B(e.row,e.column);document.getElementById(s).style.backgroundColor=r==="player1"?"red":"blue",Y(s)})}function Y(r){const e=i.loadedCharacters[t];Object.keys(e).forEach(s=>{parseInt(s)===r?e[s].mesh.visible=!0:e[s].mesh.visible=!1})}function L(){Object.keys(i.loadedCharacters).forEach(r=>{Object.keys(i.loadedCharacters[r]).forEach(e=>i.loadedCharacters[r][e].mesh.visible=!1)})}function B(r,e){var s=(r-1)*3+e;return s}function A(r){const e=window.location.href,s=e.endsWith("/")?e.slice(0,-1):e,c=s.substring(0,s.lastIndexOf("/"));window.location.href=`${c}/${r}/`}
