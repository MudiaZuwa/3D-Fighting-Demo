import"./modulepreload-polyfill-3cfb730f.js";import{h as O,i as H,D as G,m as z,W as N,L as K,o as R,T as F,a as J,P as U,M as q,f as V,p as I,A as Q,g as E}from"./index-b74b9157.js";class X{constructor({gameWidth:e,gameHeight:s}){this.gameWidth=e,this.gameHeight=s,this.init(),this.loaded=!1}init(){this.scene=new O,this.camera=new H(30,this.gameWidth/this.gameHeight,1,1e4),this.camera.position.set(0,30,1800),this.camera.lookAt(0,0,100),this.light=new G(16777215,.6),this.light.position.set(-500,300,500),this.scene.add(this.light),this.clock=new z,this.renderer=new N({antialias:!0}),this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setSize(this.gameWidth,this.gameHeight),document.getElementById("body").appendChild(this.renderer.domElement),this.loadingManager=new K;const s=new R(this.loadingManager).load(["../resources/Textures/posx.jpg","../resources/Textures/negx.jpg","../resources/Textures/posy.jpg","../resources/Textures/negy.jpg","../resources/Textures/posz.jpg","../resources/Textures/negz.jpg"]);this.scene.background=s;const g=new F(this.loadingManager).load("../resources/Textures/negy.jpg"),a=new J(new U(4150,2e3),new q({map:g}));a.rotation.x=-Math.PI/2,a.position.set(0,-450,-100),this.scene.add(a),this.loader=new V(this.loadingManager),this.loadedCharacters={player1:{},player2:{}},Object.keys(I).forEach((y,w)=>{const h=I[y];Object.keys(this.loadedCharacters).forEach(f=>{const b=this.loadedCharacters[f];this.loader.load(h.model,p=>{const k=new Q(p);p.visible=!1,p.scale.setScalar(h.scale);const C=p;f==="player1"?(C.rotation.y=Math.PI/2,C.position.set(-500,-350,-170)):(C.rotation.y=-Math.PI/2,C.position.set(500,-350,-170)),this.loader.load(h.animations[0].src,P=>{var L=k.clipAction(P.animations[0]);L.play(),this.scene.add(p);const W=w+1;b[W]={mesh:C,mixer:k}})})})})}update(){let e=this.clock.getDelta();e>.1&&(e=.1),this.loaded&&Object.keys(this.loadedCharacters).forEach(s=>{const u=this.loadedCharacters[s];Object.keys(u).forEach(g=>{u[g].mixer.update(e)})}),this.renderer.render(this.scene,this.camera)}}const Z=document.getElementById("backgroundAudio"),o=document.getElementById("miscAudio");let x={player1:null,player2:null},n={player1:{row:1,column:1},player2:{row:null,column:null}},t="player1",A=[],v,d,m=0,c,i=new X({gameWidth:innerWidth,gameHeight:innerHeight});i.loadingManager.onProgress=(r,e,s)=>{const u=e/s*100;E.to("#leftBar",{width:u+"%"}),E.to("#rightBar",{width:u+"%"})};i.loadingManager.onLoad=()=>{document.getElementById("loadingScreen").style.display="none",document.getElementById("body").style.display="block",Z.play(),v=localStorage.getItem("Mode"),d=JSON.parse(localStorage.getItem("Controllers")),v===null&&(typeof window.electronAPI<"u"?window.electronAPI.navigateTo("index.html"):location.href="../"),d===null&&(typeof window.electronAPI<"u"?window.electronAPI.navigateTo("SelectController/index.html"):window.location.href="../SelectController/"),l(),addEventListener("keydown",r=>{if(r.keyCode===76&&d.player1==="Keyboard"&&(t==="player2"?(t="player1",x.player1=null,n.player2={row:null,column:null},o.currentTime=0,o.src="../resources/Audios/menu-click-89198.mp3",o.play(),j(),l()):typeof window.electronAPI<"u"?window.electronAPI.navigateTo("SelectController/index.html"):location.href="../SelectController/"),d[t]==="Keyboard"||d.player1==="Keyboard"&&d.player2==="Computer")switch(r.keyCode){case 74:o.currentTime=0,o.src="../resources/Audios/menu-click-89198.mp3",o.play(),S();break;case 65:n[t].column>1?n[t].column--:n[t].column=3,l(),o.currentTime=0,o.src="../resources/Audios/menu-button-88360.mp3",o.play();break;case 68:n[t].column<3?n[t].column++:n[t].column=1,l(),o.currentTime=0,o.src="../resources/Audios/menu-button-88360.mp3",o.play();break;case 83:n[t].row>1?n[t].row--:n[t].row=2,l(),o.currentTime=0,o.src="../resources/Audios/menu-button-88360.mp3",o.play();break;case 87:n[t].row<2?n[t].row++:n[t].row=1,l(),o.currentTime=0,o.src="../resources/Audios/menu-button-88360.mp3",o.play();break}}),addEventListener("gamepadconnected",r=>{let e=r.gamepad.index;A.push(e)}),addEventListener("gamepaddisconnected",r=>{let e=r.gamepad.index;A=A.filter(s=>s!==e)}),addEventListener("resize",()=>{i.gameWidth=innerWidth,i.gameHeight=innerHeight,i.renderer.setSize(innerWidth,innerHeight),i.camera.aspect=innerWidth/innerHeight,i.camera.updateProjectionMatrix()}),i.loaded=!0,M()};function _(){m++,A.forEach(r=>{let e=navigator.getGamepads()[r];if(e.buttons[2].pressed&&d.player1===r&&(Math.abs(m-c)>10||c===void 0)&&(t==="player2"?(c=m,t="player1",x.player1=null,n.player2={row:null,column:null},j(),l()):typeof window.electronAPI<"u"?window.electronAPI.navigateTo("SelectController/index.html"):location.href="../SelectController/"),(d[t]===r||d.player1===r&&d.player2==="Computer")&&(Math.abs(m-c)>10||c===void 0)){var u=T(e.axes[0],.25),g=T(e.axes[1],.25),a=T(e.axes[9],.25);e.buttons.map(b=>b.pressed).forEach((b,p)=>{if(b)switch(p){case 1:c=m,o.currentTime=0,o.src="../resources/Audios/menu-click-89198.mp3",o.play(),S();break}});let y,w,h,f;if(e.buttons[12]&&e.buttons[13]&&e.buttons[14]&&e.buttons[15]?(y=e.buttons[12].pressed||a<-.9,w=e.buttons[13].pressed||a===0,h=e.buttons[14].pressed||a>0&&a<=1,f=e.buttons[15].pressed||a<0&&a>-.9):(y=a<-.9,w=a===0,h=a>0&&a<=1,f=a<0&&a>-.9),g>0||y){c=m,n[t].row>1?n[t].row--:n[t].row=2,l(),o.currentTime=0,o.src="../resources/Audios/menu-button-88360.mp3",o.play();return}if(g<0||w){c=m,n[t].row<2?n[t].row++:n[t].row=1,l(),o.currentTime=0,o.src="../resources/Audios/menu-button-88360.mp3",o.play();return}if(u>0||f){c=m,n[t].column<3?n[t].column++:n[t].column=1,l(),o.currentTime=0,o.src="../resources/Audios/menu-button-88360.mp3",o.play();return}if(u<0||h){c=m,n[t].column>1?n[t].column--:n[t].column=3,l(),o.currentTime=0,o.src="../resources/Audios/menu-button-88360.mp3",o.play();return}}})}function T(r,e,s){return s=(Math.abs(r)-e)/(1-e),s<0&&(s=0),s*(r>0?1:-1)}function M(){i.update(),_(),requestAnimationFrame(M)}function S(){const r=n[t],e=B(r.row,r.column),s=document.getElementById(e).innerText;t==="player2"&&s===x.player1||(x[t]=s,t==="player1"?(t="player2",e!==1?n[t]={row:1,column:1}:n[t]={row:1,column:2},l()):(localStorage.setItem("Characters",JSON.stringify(x)),setTimeout(()=>{typeof window.electronAPI<"u"?window.electronAPI.navigateTo("GamePage/index.html"):window.location.href="../GamePage/"},500)))}function l(){for(let r=1;r<7;r++)document.getElementById(r).style.backgroundColor="white";Object.keys(n).forEach(r=>{const e=n[r];if(e.row===null||e.column===null)return;const s=B(e.row,e.column);document.getElementById(s).style.backgroundColor=r==="player1"?"red":"blue",$(s)})}function $(r){const e=i.loadedCharacters[t];Object.keys(e).forEach(s=>{parseInt(s)===r?e[s].mesh.visible=!0:e[s].mesh.visible=!1})}function j(){Object.keys(i.loadedCharacters).forEach(r=>{Object.keys(i.loadedCharacters[r]).forEach(e=>i.loadedCharacters[r][e].mesh.visible=!1)})}function B(r,e){var s=(r-1)*3+e;return s}
